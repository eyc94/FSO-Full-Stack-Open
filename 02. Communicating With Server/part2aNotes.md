# Rendering a Collection, Modules

## console.log()
- Experienced programmers use `console.log()` very often.
- Remember not to concatenate in a `console.log()`. Use a comma.

## Protip: Visual Studio Code Snippets
- Easy to create snippets for VSCode.
    - Snippets are shortcuts for quickly generating commonly re-used portions of code.
    - Like `sout` in Netbeans.
- Instructions to create snippets: `https://code.visualstudio.com/docs/editor/userdefinedsnippets#_creating-your-own-snippets`
- There are ready-made snippets as VSCode plugins.
- Most important snippet is for `console.log()`.
    - `clog` can be created like:
```javascript
{
    "console.log": {
        "prefix": "clog",
        "body": [
            "console.log('$1')",
        ],
        "description": "Log output to console"
    }
}
```
- However, using the log function is so common, so VSCode has a snippet built in.
    - Type `log` and tab to autocomplete.

## JavaScript Arrays
- We will be using the functional programming methods of arrays.
    - `find`, `filter`, and `map`.
- These videos will help: `https://www.youtube.com/playlist?list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84`
    - Higher Order Functions: `https://www.youtube.com/watch?v=BMUiFMZr7vk&list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84`
    - Map: `https://www.youtube.com/watch?v=bCqtb-Z5YGQ&list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84&index=3`
    - Reduce Basics: `https://www.youtube.com/watch?v=Wl98eZpkp-c&t=31s`

## Event Handlers Revisited
- Look at the previous part's explanation.
- Can also find information on passing event handlers to child components.

## Rendering Collections
- We now do the 'frontend' or browser-side application logic in React.
- This is for an app that is similar to example app from part 0.
- Start with `App.js`:
```javascript
import React from 'react';

const App = (props) => {
    const { notes } = props;

    return (
        <div>
            <h1>Notes</h1>
            <ul>
                <li>{notes[0].content}</li>
                <li>{notes[1].content}</li>
                <li>{notes[2].content}</li>
            </ul>
        </div>
    )
};
```
- Next with `index.js`:
```javascript
import ReactDOM from 'react-dom';
import App from './App';

const notes = [
    {
        id: 1,
        content: 'HTML is easy',
        date: '2019-05-30T17:30:31.098Z',
        important: true
    },
    {
        id: 2,
        content: 'Browser can execute only JavaScript',
        date: '2019-05-30T18:39:34.091Z',
        important: false
    },
    {
        id: 3,
        content: 'GET and POST are the most important methods of HTTP protocol',
        date: '2019-05-30T19:20:14.298Z',
        important: true
    }
];

ReactDOM.render(
    <App notes={notes} />,
    document.getElementById('root')
);
```
- We see the array of notes.
- Indexing that way works because we have exactly 3 items in the array.
- Index is hard-coded.
- Instead of generating React elements using indices, use the array `map` function.
- We can generate React elements like so.
```javascript
notes.map(note => <li>{note.content}</li>);
```
- The result is an array of `li` elements:
```javascript
[
    <li>HTML is easy</li>,
    <li>Browser can execute only JavaScript</li>,
    <li>GET and POST are the most important methods of HTTP protocol</li>
]
```
- Can be placed inside `ul` tags:
```javascript
const App = (props) => {
    const { notes } = props;

    return (
        <div>
            <h1>Notes</h1>
            <ul>
                {notes.map(note => <li>{note.content}</li>)}
            </ul>
        </div>
    )
};
```
- Notice the JS code in the JSX template wrapped in curly braces.
- We can make it more readable.
```javascript
const App = (props) => {
    const { notes } = props;

    return (
        <div>
            <h1>Notes</h1>
            <ul>
                {notes.map(note =>
                    <li>
                        {note.content}
                    </li>
                )}
            </ul>
        </div>
    )
};
```

## Key-Attribute
- App seems to be working but there is an error in the console.
```
Each child in an array or iterator should have a unique "key" prop.
```
- This says the list items generated by the `map` method **must** have a unique key value.
    - This attribute is called `key`.
- Add the keys:
```javascript
const App = (props) => {
    const { notes } = props;

    return (
        <div>
            <h1>Notes</h1>
            <ul>
                {notes.map(note =>
                    <li key={note.id}>
                        {note.content}
                    </li>
                )}
            </ul>
        </div>
    )
};
```
- Error message disappears.
- React uses the key to determine how to update views generated by a component when component is re-rendered.

## Map
- App contains an array called `notes`:
```javascript
const notes = [
    {
        id: 1,
        content: 'HTML is easy',
        date: '2019-05-30T17:30:31.098Z',
        important: true
    },
    {
        id: 2,
        content: 'Browser can execute only JavaScript',
        date: '2019-05-30T18:39:34.091Z',
        important: false
    },
    {
        id: 3,
        content: 'GET and POST are the most important methods of HTTP protocol',
        date: '2019-05-30T19:20:14.298Z',
        important: true
    }
];
```
- Examine how `map` works:
- Say the following code is added to end of file:
```javascript
const result = notes.map(note => note.id);
console.log(result);
```
- `[1, 2, 3]` is printed to the console.
- The `map` function always creates a new array.
    - The new elements are created from the old elements of the original array.
    - This is done by `mapping`.
    - It uses the function given as a parameter.
```javascript
note => note.id
```
- The function is in array form. The full form is:
```javascript
(note) => {
    return note.id;
}
```
- Function gets a node object as a parameter.
- It returns the value of its `id` field.
- Change the command to:
```javascript
const result = notes.map(note => note.content);
```
- This results in an array with the contents of the notes.
- This is close to the React code:
```javascript
notes.map(note => 
    <li key={note.id}>{note.content}</li>
);
```
- Must use curly braces.

## Anti-Pattern: Array Indexes as Keys
- With the error message from earlier, I could have fixed by using array indices as keys.
- Indices can be retrieved with a second parameter to the callback function of `map`:
```javascript
notes.map((note, i) => ...);
```
- The `i` is assigned the value of the index of the note.
- So, one way to define row generation:
```javascript
<ul>
    {notes.map((note, i) =>
        <li key={i}>
            {note.content}
        </li>
    )};
</ul>
```
- This is NOT recommended.
- Read more about it here: `https://robinpokorny.medium.com/index-as-a-key-is-an-anti-pattern-e0349aece318`

## Refactoring Modules
- Refactor a bit by destructuring:
```javascript
const App = ({ notes }) => {
    return (
        <div>
            <h1>Notes</h1>
            <ul>
                {notes.map(note =>
                    <li key={note.id}>
                        {note.content}
                    </li>
                )};
            </ul>
        </div>
    )
};
```
- Separate displaying single note into its own component `Note`.
```javascript
const Note = ({ note }) => {
    return (
        <li>{note.content}</li>
    )
};

const App = ({ notes }) => {
    return (
        <div>
            <h1>Notes</h1>
            <ul>
                {notes.map(note =>
                    <Note key={note.id} note={note} />
                )}
            </ul>
        </div>
    )
};
```
- Note the `key` attribute is defined in the `Note` component tag.
    - It used to be defined in the `li` tag.
- It is good practice to declare each component in their own file as an `ES6-module`.
- Have been using modules this whole time.
```javascript
import ReactDOM from 'react-dom';
import App from './App';
```
- This imports two modules to use in the file.
- The modules are placed in variables called `ReactDOM` and `App`, respectively.
- Move `Note` component to its own module.
    - Components are placed in folder called `components`.
    - `components` is placed in a folder called `src`.
    - Name the file after the component.
- So, created folder called `components` and place a file called `Note.js` in it.
- The contents of `Note.js` is below:
```javascript
import React from 'react';

const Note = ({ note }) => {
    return (
        <li>{note.content}</li>
    )
};

export default Note;
```
- This is a React component, so import React.
- The last line exports the module, the variable `Note`.
- The file using the component can `import` the module:
```javascript
import React from 'react';
import Note from './components/Note';

const App = ({ note }) => {
    // ...
};
```
- Location must be given in relation to the importing file.
- The period means the current directory.
- The `.js` extension can be omitted.
- Modules have other uses than component declarations.

## When The Application Breaks
- Applications can break.
- Best way is to use `console.log()`.
- Try to log one step at a time to check one layer is working before moving to the next layer.
- Remove destructuring to see the variables' values.